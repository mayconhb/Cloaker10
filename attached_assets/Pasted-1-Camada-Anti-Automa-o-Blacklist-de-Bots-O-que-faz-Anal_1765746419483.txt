1 - Camada Anti-Automação (Blacklist de Bots)
O que faz: Analisa o "User-Agent" em busca de assinaturas de ferramentas de clonagem e scripts de programação.

Alvos: headless chrome, puppeteer, selenium, python, curl, wget, ahrefs, semrush.

Ação: Bloqueia e envia para a Safe Page.

Por que: Impede que concorrentes usem softwares para baixar/copiar sua página de vendas automaticamente.





2 - Camada de Filtro de Dispositivo (Device Check)
O que faz: Verifica se o acesso está vindo de um Computador (Desktop) ou Celular (Mobile).

Configuração: Escolher dispositivos para bloquear no painel de criação de campanha

Ação: Se for Desktop e a regra estiver ativa, bloqueia.

Por que: A maioria dos espiões e clonadores manuais trabalha sentado na frente de um computador.




3 - Camada de Geolocalização (Geo Block)
O que faz: Verifica o país de origem do IP do visitante.

Configuração: Escolher países para bloquear no painel de criação de campanha

Ação: Se o IP for de um país bloqueado, envia para a Safe Page.

Por que: Filtra bots globais e curiosos que não são do seu mercado-alvo




4 - Camada de Trava de Origem Híbrida (Origin Lock)
O que faz: Verifica se o clique tem "rastros" de ser legítimo de um anúncio.

Regra: Exige que a URL tenha o parâmetro fbclid OU que o navegador seja o interno do app (Instagram, Facebook App, Messenger).

Ação: Se alguém copiar o link limpo e colar no Chrome, é bloqueado.

Por que: É a proteção mais forte contra espionagem manual (Biblioteca de Anúncios) e tráfego orgânico "sujo", sem perder vendas de iOS (que removem parâmetros).



Detalhamento da camada 4:

Camada 4: Trava de Origem Híbrida (Origin Lock)

O Objetivo: Garantir que o visitante realmente clicou em um anúncio e não está tentando acessar seu site diretamente (copiando e colando o link) ou usando ferramentas de espionagem.

Esta camada funciona como um segurança na porta de uma festa que exige um convite carimbado ou um crachá de funcionário para deixar entrar.

1. Como ela funciona (A Lógica do "OU")
Diferente de travas antigas que exigiam uma senha fixa (tipo ?k=venda), esta trava é dinâmica. Ela analisa duas características da visita e libera se pelo menos uma for verdadeira:

Verificação A (O Convite): O parâmetro fbclidQuando qualquer pessoa clica em um anúncio no Facebook ou Instagram, a plataforma adiciona automaticamente um código único ao final do link, chamado fbclid (Facebook Click ID).

O Teste: O sistema olha para a URL. Tem fbclid=?Se SIM: É um clique legítimo de anúncio. LIBERA.

Verificação B (O Crachá): O Navegador Interno (In-App Browser)Quando você clica num link dentro do Instagram, ele não abre o Google Chrome ou Safari externamente. Ele abre um navegadorzinho dentro do próprio Instagram.Esse navegador interno se identifica (via User-Agent) com nomes específicos como Instagram, FBAN (Facebook Android) ou FBAV.

O Teste: O sistema olha para o User-Agent. É um navegador interno do Facebook/Instagram?Se SIM: O usuário está dentro do app. LIBERA.

A Regra Final:Se não tiver fbclid E não estiver no navegador interno → BLOQUEIA (Envia para Safe Page).

2. Por que essa "Hibridez" é necessária? (O Problema do iOS 17)

Você pode perguntar: "Por que não exigir apenas o fbclid?"

A resposta é a Apple. Nas atualizações recentes do iPhone (iOS 17+), a Apple introduziu uma função de privacidade que remove automaticamente parâmetros de rastreamento das URLs quando o usuário navega no modo privado ou em certos contextos.

Cenário sem a Verificação B: Um cliente real com iPhone clica no seu anúncio. A Apple remove o fbclid antes de chegar no seu site. Seu cloaker não vê o código e bloqueia uma venda real.

Cenário COM a Verificação B: O cloaker vê que não tem fbclid, MAS percebe que o acesso está vindo de dentro do app do Instagram (InAppBrowser). Ele entende que é um usuário legítimo de iPhone e libera a venda.

3. O Duelo: Por que NÃO usar o Referer?

O Referer é um cabeçalho que o navegador envia dizendo "eu vim do site X". Antigamente, usava-se muito isso (if referer contains 'facebook' -> libera). Hoje, isso é uma prática ruim e perigosa por três motivos:

O Problema do Referer (Método Antigo)
Confiabilidade
Baixa. Muitos aplicativos e antivírus removem o Referer por privacidade. Você bloqueia cerca de 20% do tráfego real.

Segurança
Baixa. É trivial falsificar. Qualquer bot de 5ª categoria pode enviar um cabeçalho dizendo Referer: facebook.com.

Ambiente Mobile
"Péssima. Ao transitar de um App (HTTPS) para um Site (HTTPS), o cabeçalho Referer frequentemente é perdido."


A Vantagem da Trava Híbrida (Nosso Método)
Confiabilidade
"Alta. O App do Facebook não consegue ""esconder"" que é ele mesmo (User-Agent), e o fbclid é injetado pelo próprio anúncio."

Segurança
Média/Alta. Falsificar um fbclid válido ou simular perfeitamente o ambiente de um navegador In-App requer bots muito mais sofisticados.

Ambiente Mobile
Excelente. Foi desenhada especificamente para o comportamento mobile e o ecossistema de Apps da Meta.


------------------------------------------------------------

INSTRUÇÕES VISUAIS DO GEMINI PARA O REPLIT

------------------------------------------


# ATENÇÃO: INSTRUÇÕES DE UI/UX E DESIGN SYSTEM (LinkShield)

Atue como um **Lead Product Designer** e **Engenheiro Frontend Sênior**. O código funcional é importante, mas a **EXCELÊNCIA VISUAL** é a prioridade máxima nesta etapa.

Eu NÃO quero um visual "padrão Bootstrap" ou "HTML cru".
Eu quero um visual **Premium SaaS**, Dark Mode, minimalista e sofisticado, similar aos painéis da Vercel, Linear ou Supabase.

## 1. DESIGN SYSTEM & FUNDAÇÃO (Obrigatório)

- **Biblioteca de Componentes:** Você DEVE instalar e usar **Shadcn/UI** para TUDO (Buttons, Inputs, Cards, Dialogs, Sheets, Switches, Badges, Tables).
- **CSS Framework:** Tailwind CSS.
- **Paleta de Cores:**
  - **Background:** `zinc-950` (#09090b) - Quase preto, não preto puro.
  - **Surface/Cards:** `zinc-900` com bordas sutis em `zinc-800`.
  - **Primary (Acento):** Branco puro (`#ffffff`) para texto e botões principais (Invertido).
  - **Secondary:** `zinc-800` para botões secundários.
  - **Semantic Colors:**
    - `emerald-500`: Para Status "Allowed" / "Ativo".
    - `rose-500`: Para Status "Blocked" / "Erro".
    - `amber-500`: Para Alertas.
- **Tipografia:** Fonte `Inter` ou `Geist Sans` (via `next/font`). Use espaçamento de letras (tracking-tight) em títulos.
- **Ícones:** Use `lucide-react`. Escolha ícones com traços finos (stroke-width 1.5 ou 2).

## 2. LAYOUT GLOBAL (Shell)

- Crie um **Header (Navbar)** fixo no topo com efeito "Glassmorphism" (backdrop-filter: blur).
  - Logo: Texto simples "LinkShield" em negrito, tracking-tighter.
  - Navegação: Links sutis (Dashboard, Analytics). Estado ativo deve ter cor branca, inativo cinza.
  - User Menu: Avatar simples à direita.
- **Espaçamento:** Use containers centralizados (`max-w-6xl mx-auto`) com padding generoso (`p-6` ou `p-8`). Nada deve parecer "espremido".

## 3. PÁGINA: DASHBOARD (`/admin`)

Não use tabelas feias padrão. Use o componente `Table` do Shadcn dentro de um `Card`.
- **KPI Cards (Topo):** 3 Cards lado a lado (Total Campanhas, Cliques Hoje, Bloqueios Hoje). Use ícones grandes e opacos no fundo do card para decoração.
- **Tabela de Campanhas:**
  - Cabeçalho da tabela com texto cinza claro (`text-zinc-400`).
  - Linhas com hover sutil (`hover:bg-zinc-800/50`).
  - Coluna "Status": Use um `Badge` pequeno (verde ou cinza).
  - Coluna "Slug": Fonte mono-espaçada, cor cinza, com um botão ícone pequeno para "Copiar Link".
  - Botão de Ação: "Nova Campanha" deve ser o destaque visual da página (Botão Branco).

## 4. PÁGINA: CRIAR CAMPANHA (`/admin/new`) - A Mais Importante

Esta página deve parecer um "Setup Wizard" profissional. NÃO coloque um formulário gigante vertical. Organize em **Cards Lógicos** com títulos claros e descrições auxiliares (`text-sm text-muted-foreground`).

- **Card 1: Identidade**
  - Inputs grandes para Nome e Slug.
  - Input para Safe URL.

- **Card 2: Engenharia de Tráfego (Split Test)**
  - Crie uma interface visual para os destinos.
  - Use um botão "+ Adicionar Oferta".
  - Cada oferta deve ser uma linha com: Input de ID (pequeno), Input de URL (grande), Slider ou Input numérico para Peso.
  - Use ícones de "Lixeira" para remover uma oferta.

- **Card 3: O "Escudo" (Segurança)**
  - Aqui está o "Ouro" da UX. Não use apenas checkboxes. Use **Switches (Toggles)** alinhados à direita.
  - Layout de cada item:
    [ Ícone Desktop ] **Bloquear Desktop** [ Switch ]
    *Texto pequeno explicando: "Impede acesso via PC."*
    -------------------------------------------------------
    [ Ícone Globo ]   **Bloqueio Geográfico** [ Select Multi ]
    *Texto pequeno: "Permite apenas Brasil."*
    -------------------------------------------------------
    [ Ícone Cadeado ] **Trava de Origem** [ Switch ]
    *Texto pequeno: "Exige fbclid ou App Browser."*

## 5. PÁGINA: ANALYTICS (`/admin/[id]`)

Use a biblioteca `recharts`.
- **Visual dos Gráficos:**
  - Remova as "grids" de fundo dos gráficos (deixe limpo).
  - Use Tooltips customizados (fundo escuro, borda fina).
  - Cores das linhas: `emerald-500` (Allowed) vs `rose-500` (Blocked).
  - Gráfico de Pizza (Donut): Deve ter um buraco no meio. Legenda limpa ao lado.

## 6. MICRO-INTERAÇÕES (O Toque Final)

- **Loading States:** Quando clicar em "Salvar", o botão deve mostrar um "Spinner" e ficar desabilitado.
- **Toasts:** Use o componente `Sonner` ou `Toast` do Shadcn. Quando salvar, exiba: "Campanha criada com sucesso" (borda verde). Se der erro: "Falha ao salvar" (borda vermelha).
- **Transições:** Adicione `transition-all duration-200` em botões e inputs para suavizar o hover.

---

**Comando Final:**
Implemente essas diretrizes visuais AGORA. Refatore o frontend existente para usar estritamente Shadcn/UI e Tailwind com essas escolhas estéticas. Quero que o resultado pareça um produto profissional pronto para venda.